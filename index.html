<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartCents - Dashboard</title>
    <link rel="icon" type="image/png" href="ChatGPT Image Aug 23, 2025, 06_04_58 PM.png">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/openai@4.0.0/dist/index.min.js"></script>
</head>
<body>
     <nav class="navbar">
        <a href="index.html" class="backbutton">
            <i class="bi bi-arrow-left"></i>
        </a>
        <div class="nav-brand">SmartCents</div>
        <div class="nav-links">
            <a href="index.html" class="nav-link active">Dashboard</a>
            <a href="add-expense.html" class="nav-link">Add Expense</a>
            <a href="set-goal.html" class="nav-link">Set Goal</a>
            <a href="mentor.html" class="nav-link">Mentor</a>
            <a href="budget-game.html" class="nav-link">Game</a>
            <a href="skill-tree.html" class="nav-link">Skill Path</a>
        </div>
  </nav>

    <main class="container">
        <header class="page-header">
            <h1>Your Financial Dashboard</h1>
            <p class="tagline">Master your money, master your independence.</p>
            <button id="refreshDashboard" class="btn btn-primary" onclick="refreshDashboard()" style="margin-top: 1rem;">
                <i class="bi bi-arrow-clockwise"></i> Refresh Dashboard
            </button>
        </header>

        <div class="dashboard-grid">
            <div class="card independence-score-card">
                <h2>Independence Score</h2>
                <div class="score-display">
                    <span id="independenceScore" class="score-number">0</span>
                    <span class="score-max">/100</span>
                </div>
                <p class="score-description">Your financial independence rating</p>
                

                
                <!-- Score Change Log -->
                <div class="score-log-section">
                    <div class="score-log-header">
                        <h3>Recent Score Changes</h3>
                        <div class="log-actions">
                            <button id="viewAllChanges" class="btn btn-outline btn-sm" onclick="toggleScoreLog()">View All</button>
                        </div>
                    </div>
                    <div id="scoreLogContainer" class="score-log-container">
                        <div class="loading-placeholder">
                            <div class="loading-spinner"></div>
                            <p>Loading score changes...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card spending-breakdown-card">
                <h2>Spending Breakdown</h2>
                <div class="chart-container">
                    <canvas id="spendingPieChart"></canvas>
                </div>
            </div>

            <div class="card weekly-spending-card">
                <h2>Weekly Spending Trend</h2>
                <div class="chart-container">
                    <canvas id="weeklyBarChart"></canvas>
                </div>
            </div>

            <div class="card goal-progress-card">
                <h2>Savings Goals</h2>
                <div id="goalsList" class="goals-list">
                    <p class="no-goals">No goals set yet. <a href="set-goal.html">Create your first goal</a></p>
                </div>
            </div>

            <div class="card mentor-tip-card">
                <h2>Mentor Tip <span style="font-size: 0.9rem; color: #10b981; font-weight: 400;"> ‚Üí Powered by OpenAI</span></h2>
                <div id="mentorTip" class="mentor-tip">
                    <p>Loading your personalized financial advice...</p>
                </div>
            </div>

            <div class="card quick-actions-card">
                <h2>Quick Actions</h2>
                <div class="action-buttons">
                    <a href="add-expense.html" class="btn btn-primary">Add Transaction</a>
                    <a href="set-goal.html" class="btn btn-secondary">Set New Goal</a>
                    <a href="mentor.html" class="btn btn-outline">Get Advice</a>
                    <button onclick="resetAllGoals()" class="btn btn-outline" style="background-color: #e53e3e; color: white; border-color: #e53e3e;">Reset All Goals</button>
                </div>
            </div>
        </div>
    </main>

      <script>


        function checkBackendConnection() {
          fetch(`${window.backendUrl}/api/health`)
            .then(response => response.json())
            .then(data => {
              console.log('‚úÖ Backend connected:', data);
              window.backendReady = true;
            })
            .catch(error => {
              console.log('‚ùå Backend not accessible:', error);
              window.backendReady = false;
              setTimeout(checkBackendConnection, 2000);
            });
        }
        
        setTimeout(checkBackendConnection, 1000);
      </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
    
    <script>
                               if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    window.backendUrl = 'http://localhost:3000';
                    console.log('üåê Detected LOCAL environment - using localhost:3000');
                } else {
                   window.backendUrl = 'https://your-backend-url.com';
                   console.log('üåê Detected PRODUCTION environment - using production backend');
               }
    </script>
</body>
</html>
